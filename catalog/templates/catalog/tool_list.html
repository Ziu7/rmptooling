{% extends "base_generic.html" %}

{% block content %}
	<h1>Tool Catalog</h1>
	<a href="{% url 'tool-create' %}" class="btn btn-primary">Add new tool</a>
	<hr>
	{% if tool_list %}
	<table id="tool_list" class="table table-striped table-hover table-responsive table-sm">
		<thead class="thead-light">
			<tr>
				<th>Tool Number (Name)</th>
				<th>Minimum Required</th>
				<th>Count <span style="color:red">(Need Repair)</span></th>
				<th>Primary Discipline</th>
				<th>Secondary Discipline</th>
				<th>DNGS CatID</th>
				<th>PNGS CatID</th>
			</tr>
		</thead>

		<tbody>
			{% for tool in tool_list %}
				<tr {% if not tool.sufficienttools %}class="table-danger"{% endif %}>
					<td><a href="{{ tool.get_absolute_url }}">{{tool}}</a></td>
					<td>{{ tool.minneeded }} </td>
					<td>{{ tool.toolcount }} <span style="color:red">({{ tool.damagedcount }})</span></td>
					<td>{{ tool.primdisc }}</td>
					<td>{{ tool.secdisc }}</td>
					<td>{{ tool.dcatid }}</td>
					<td>{{ tool.pcatid }}</td>
				</tr>
			{% endfor %}
		</tbody>

	</table>

	{% else %}
		<p>There are no tools in the database. </p>

	{% endif %}

<!-- table filter js -->
	<script language="javascript" type="text/javascript">
		var props01 = {
			col_1:'none',
			col_2:'none',
			col_3:'select',
			col_4:'select',
			col_5:'none',
			col_6:'none',

			};

		var tf = new TableFilter("tool_list",props01);
		tf.init();
	</script>

	<script language="javascript" type="text/javascript">
		// table sorting function
		function sortTable(n) {
			var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount=0;
			table = document.getElementById("tool_list");
			switching = true;
			// set the sorting direction to ascending:
			dir = "asc";
			// make a loop that will continue until no switching has been done:
			while (switching) {
				//start by saying there is no switching
				switching=false;
				rows = table.getElementsByTagName("tr");
				// loop through all table rows (except header)
				for (i=1; i < (rows.length -1); i++) {
					//start by saying there is no switching
					switching=false;
					// get two elements you want to compare from current
					x=rows[i].getElementsByTagName("td")[n];
					y=rows[i+1].getElementsByTagName("td")[n];
					// check if the two rows should switch places (asc or desc)
					if (dir == "asc") {
						if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
								// if so make switch and break loop
								shouldSwitch=true;
								break;
						}
					} else if (dir == "desc"){
						if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
								// if so make switch and break loop
								shouldSwitch=true;
								break;
						}
					}
				}
				if (shouldSwitch) {
					// if switch has been marked, make switch and mark that switch has been done
					rows[i].parentNode.insertBefore(rows[i+1],rows[i]);
					switching=true;
					// each time a switch is done increase count
					switchcount ++;
				} else {
					// if no switching has been done and direction is 'asc', set dir. to 'desc' and run loop
					if (switchcount ==0 && dir == "asc"){
						dir = "desc";
						switching=true;
					}
				}
			}
		}
	</script>

{% endblock %}